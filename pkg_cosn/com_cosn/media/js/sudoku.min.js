var solution,number_color;function getPuzzle(r,e){if(r=r+"&lang="+jQuery("#language").text(),"null"==e){for(var o=0,i=0;i<3;++i)1==jQuery("#level"+i).prop("checked")&&(o=jQuery("#level"+i).val());r=r+"&sudokuid=null&level="+o}else r+=e;jQuery("#button1").prop("disabled",!0),jQuery("#button2").prop("disabled",!0),jQuery("#button3").prop("disabled",!0),jQuery("#messages").attr("style","visibility: hidden"),jQuery.ajax({url:r,type:"GET",dataType:"json",error:function(r,e,o){jQuery("#button1").prop("disabled",!1),jQuery("#button2").prop("disabled",!1),jQuery("#button3").prop("disabled",!1),jQuery("#messages").html("<span style='color: red'>Ajax Error - Reason: "+r.status+" "+o+"</span>"),jQuery("#messages").attr("style","visibility: visible")},success:onSuccess,async:!0})}function onSuccess(r){jQuery("#button1").prop("disabled",!1),jQuery("#button2").prop("disabled",!1),jQuery("#button3").prop("disabled",!1);var e=sudoku_solver();solution="";for(var o=e(r.puzzle,2),i=0;i<o.length;++i)solution+=o[i].join("")+"\n";showSudoku(r.puzzle);var u=r.puzzle_id;u="de"==jQuery("#language").text()?u.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."):u.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),jQuery("#sudokuid").html("<h2>Sudoku - "+u+"</h2>")}function checkValues(){if(1==jQuery("#help").prop("checked")||1==jQuery("#check").prop("checked"))if(1==jQuery("#help").prop("checked")){showCandidates();for(var r=0;r<81;++r)0==Query("#i"+r).prop("readonly")&&checkValue(r,!1,!1)}else for(r=0;r<81;++r)jQuery("#candidates"+r).attr("style","visibility: hidden"),checkValue(r,!1,!1);else for(r=0;r<81;++r)jQuery("#candidates"+r).attr("style","visibility: hidden")}function checkValue(r,e,o){var i=jQuery("#i"+r).val();1!=jQuery("#i"+r).prop("readonly")&&(isNaN(i)||"0"===i?jQuery("#i"+r).val(""):solution.substr(r,1)!=i&&""!=jQuery("#i"+r).val()?1!=jQuery("#help").prop("checked")&&1!=jQuery("#check").prop("checked")||jQuery("#i"+r).attr("style","color: red"):(jQuery("#i"+r).attr("style","color: green"),1==jQuery("#help").prop("checked")&&1==o&&showCandidates(),checkSolved(e)))}function checkSolved(r){for(var e=!0,o=0;o<81;++o)jQuery("#i"+o).val()!=solution.substr(o,1)&&(e=!1),1==jQuery("#i"+o).prop("readonly")&&null==number_color&&(number_color=jQuery("#i"+o).css("color"));1==e&&1==r&&(jQuery("#button2").attr("style","visibility: hidden"),jQuery("#messages").html(jQuery("#msgbox_content").html()),jQuery("#messages").css("visibility","visible").hide().fadeIn()),0==e&&(jQuery("#button2").attr("style","visibility: visible"),jQuery("#messages").attr("style","visibility: hidden"))}function showSudoku(r){for(var e=0;e<81;++e)"."!=r.substr(e,1)?(jQuery("#i"+e).val(r.substr(e,1)),jQuery("#i"+e).attr("readonly",!0),jQuery("#i"+e).removeClass("sudoku-nonumber"),jQuery("#i"+e).addClass("sudoku-number"),number_color&&jQuery("#i"+e).css("color",number_color)):(jQuery("#i"+e).val(""),jQuery("#i"+e).attr("readonly",!1),jQuery("#i"+e).removeClass("sudoku-number"),jQuery("#i"+e).addClass("sudoku-nonumber")),1==jQuery("#help").prop("checked")?showCandidates():jQuery("#candidates"+e).attr("style","visibility: hidden");jQuery("#button2").attr("style","visibility: visible")}function showCandidates(){for(var r=new Array(9),e=0;e<10;e++)r[e]=new Array(9);var o=[],i=0;for(e=0;e<9;e++)for(var u=0;u<9;u++)r[e][u]=jQuery("#i"+i).val(),jQuery("#i"+i).val()!=solution.substr(i,1)&&(r[e][u]=""),i++;var t=new Array(9),l=new Array(9),s=new Array(9);for(e=0;e<9;e++)t[e]=[0,1,2,3,4,5,6,7,8,9],l[e]=[0,1,2,3,4,5,6,7,8,9],s[e]=[0,1,2,3,4,5,6,7,8,9],t[e]=checkRow(e,r,t[e]),l[e]=checkColumn(e,r,l[e]),s[e]=checkBox(e,r,s[e]);k=0;for(e=0;e<9;e++)for(u=0;u<9;u++){o[k]="";var a=!1;for(i=1;i<10;i++){var n=getBoxNr(e,u);t[e][i]==l[u][i]&&t[e][i]==s[n][i]&&0!=t[e][i]&&0!=l[u][i]&&0!=s[n][i]&&(o[k].length>4&&0==a?(o[k]+="<br />"+t[e][i],a=!0):o[k]+=t[e][i])}jQuery("#i"+k).val()==solution.substr(k,1)?jQuery("#candidates"+k).attr("style","visibility: hidden"):(jQuery("#candidates"+k).html(o[k]),jQuery("#candidates"+k).attr("style","visibility: visible")),k++}}function getBoxNr(r,e){var o=0;return r<3&&e<3&&(o=0),r<3&&e<6&&e>2&&(o=1),r<3&&e>5&&(o=2),r<6&&r>2&&e<3&&(o=3),r<6&&r>2&&e<6&&e>2&&(o=4),r<6&&r>2&&e>5&&(o=5),r>5&&e<3&&(o=6),r>5&&e<6&&e>2&&(o=7),r>5&&e>5&&(o=8),o}function checkRow(r,e,o){for(var i=0;i<9;i++)""!=e[r][i]&&(o[e[r][i]]=0);return o}function checkColumn(r,e,o){for(var i=0;i<9;i++)""!=e[i][r]&&(o[e[i][r]]=0);return o}function checkBox(r,e,o){0==r&&(bi=0,bj=0,li=3,lj=3),1==r&&(bi=0,bj=3,li=3,lj=6),2==r&&(bi=0,bj=6,li=3,lj=9),3==r&&(bi=3,bj=0,li=6,lj=3),4==r&&(bi=3,bj=3,li=6,lj=6),5==r&&(bi=3,bj=6,li=6,lj=9),6==r&&(bi=6,bj=0,li=9,lj=3),7==r&&(bi=6,bj=3,li=9,lj=6),8==r&&(bi=6,bj=6,li=9,lj=9);for(var i=bi;i<li;i++)for(var u=bj;u<lj;u++)""!=e[i][u]&&(o[e[i][u]]=0);return o}function showSolution(){for(var r=0;r<81;++r)0==jQuery("#i"+r).prop("readonly")?(jQuery("#i"+r).val(solution.substr(r,1)),jQuery("#i"+r).css("color","green"),jQuery("#candidates"+r).attr("style","visibility: hidden")):null==number_color&&(number_color=jQuery("#i"+r).css("color"));jQuery("#button2").attr("style","visibility: hidden")}function sudoku_solver(){var r,e,o,i,u,t=[],l=[];for(r=o=0;r<9;++r)for(e=0;e<9;++e)for(k=0;k<9;++k)t[o++]=[9*r+e,9*(3*Math.floor(r/3)+Math.floor(e/3))+k+81,9*r+k+162,9*e+k+243];for(i=0;i<324;++i)l[i]=[];for(o=0;o<729;++o)for(u=0;u<4;++u)l[t[o][u]].push(o);function s(r,e,o,i){for(var u=10,s=0,a=0;a<4;++a)e[t[o][a]]+=i<<7;for(a=0;a<4;++a){var n,y,d,c=t[o][a];if(i>0){for(n=0;n<9;++n)if(0==r[y=l[c][n]]++)for(d=0;d<4;++d){var j=t[y][d];--e[j]<u&&(u=e[j],s=j)}}else for(n=0;n<9;++n)if(0==--r[y=l[c][n]]){var b=t[y];++e[b[0]],++e[b[1]],++e[b[2]],++e[b[3]]}}return u<<16|s}return function(r,e){var o,i,u,t,a=0,n=[],y=[],d=[],c=[],j=[],b=[];for(null==e&&(e=2),o=0;o<729;++o)n[o]=0;for(i=0;i<324;++i)y[i]=9;for(var v=0;v<81;++v){var f=r.charAt(v)>="1"&&r.charAt(v)<="9"?r.charCodeAt(v)-49:-1;f>=0&&s(n,y,9*v+f,1),f>=0&&++a,d[v]=c[v]=-1,j[v]=f+1}v=0;for(var Q=1,h=655360;;){for(;v>=0&&v<81-a;){if(1==Q){if(t=h>>16,c[v]=65535&h,t>1)for(i=0;i<324&&!(y[i]<t&&(t=y[i],c[v]=i,t<=1));++i);0!=t&&10!=t||(d[v--]=Q=-1)}for(i=c[v],-1==Q&&d[v]>=0&&s(n,y,l[i][d[v]],-1),u=d[v]+1;u<9&&0!=n[l[i][u]];++u);u<9?(h=s(n,y,l[i][u],1),d[v++]=u,Q=1):d[v--]=Q=-1}if(v<0)break;for(var p=[],k=0;k<81;++k)p[k]=j[k];for(k=0;k<v;++k)o=l[c[k]][d[k]],p[Math.floor(o/9)]=o%9+1;if(b.push(p),b.length>=e)return b;--v,Q=-1}return b}}